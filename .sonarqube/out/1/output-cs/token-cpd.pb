ƒœ
HC:\Projects\WebAPI-master\WebAPI.Repository\Cliente\ClienteRepository.cs
	namespace		 	
WebAPI		
 
.		 

Repository		 
.		 
Cliente		 #
{

 
public 

class 
ClienteRepository "
:# $
IClienteRepository% 7
{ 
public 
IConfiguration 
Configuration +
;+ ,
private 
string 
SqlConnectionString *
;* +
public 
ClienteRepository  
(  !
IConfiguration! /
configuration0 =
)= >
{ 	
Configuration 
= 
configuration )
;) *
SqlConnectionString 
=  !
Configuration" /
./ 0

GetSection0 :
(: ;
$str; N
)N O
[O P
$strP e
]e f
;f g
} 	
public 
int 
Delete 
( 
int 
id  
)  !
{ 	
int 
retorno 
= 
$num 
; 
using 
( 
SqlConnection  
conn! %
=& '
new( +
SqlConnection, 9
(9 :
SqlConnectionString: M
)M N
)N O
{ 
try 
{ 
conn 
. 
Open 
( 
) 
;  
using!! 
(!! 

SqlCommand!! %
comm!!& *
=!!+ ,
conn!!- 1
.!!1 2
CreateCommand!!2 ?
(!!? @
)!!@ A
)!!A B
{"" 
comm## 
.## 
CommandType## (
=##) *
CommandType##+ 6
.##6 7
Text##7 ;
;##; <
comm$$ 
.$$ 
CommandText$$ (
=$$) *
$str$$+ P
;$$P Q
comm&& 
.&& 

Parameters&& '
.&&' (
Add&&( +
(&&+ ,
new&&, /
SqlParameter&&0 <
(&&< =
$str&&= A
,&&A B
id&&C E
)&&E F
)&&F G
;&&G H
retorno(( 
=((  !
comm((" &
.((& '
ExecuteNonQuery((' 6
(((6 7
)((7 8
;((8 9
})) 
return++ 
retorno++ "
;++" #
},, 
catch-- 
(-- 
	Exception--  
ex--! #
)--# $
{.. 
throw// 
new// 
	Exception// '
(//' (
$"//( *
{//* +
ex//+ -
.//- .
Message//. 5
}//5 6
$str//6 9
{//9 :
ex//: <
.//< =

StackTrace//= G
}//G H
"//H I
)//I J
;//J K
}00 
finally11 
{22 
conn33 
.33 
Close33 
(33 
)33  
;33  !
}44 
}55 
}66 	
public88 
ClienteDomain88 
Get88  
(88  !
int88! $
id88% '
)88' (
{99 	
ClienteDomain:: 
retorno:: !
=::" #
null::$ (
;::( )
using<< 
(<< 
SqlConnection<<  
conn<<! %
=<<& '
new<<( +
SqlConnection<<, 9
(<<9 :
SqlConnectionString<<: M
)<<M N
)<<N O
{== 
try>> 
{?? 
conn@@ 
.@@ 
Open@@ 
(@@ 
)@@ 
;@@  
usingBB 
(BB 

SqlCommandBB %
commBB& *
=BB+ ,
connBB- 1
.BB1 2
CreateCommandBB2 ?
(BB? @
)BB@ A
)BBA B
{CC 
commDD 
.DD 
CommandTypeDD (
=DD) *
CommandTypeDD+ 6
.DD6 7
TextDD7 ;
;DD; <
commEE 
.EE 
CommandTextEE (
=EE) *
$strEE+ S
;EES T
commGG 
.GG 

ParametersGG '
.GG' (
AddGG( +
(GG+ ,
newGG, /
SqlParameterGG0 <
(GG< =
$strGG= B
,GGB C
idGGD F
)GGF G
)GGG H
;GGH I
usingII 
(II 
SqlDataReaderII ,
readerII- 3
=II4 5
commII6 :
.II: ;
ExecuteReaderII; H
(IIH I
)III J
)IIJ K
{JJ 
ifKK 
(KK  
readerKK  &
.KK& '
HasRowsKK' .
)KK. /
{LL 
readerMM  &
.MM& '
ReadMM' +
(MM+ ,
)MM, -
;MM- .
retornoOO  '
=OO( )
newOO* -
ClienteDomainOO. ;
(OO; <
)OO< =
;OO= >
retornoQQ  '
.QQ' (
IdQQ( *
=QQ+ ,
intQQ- 0
.QQ0 1
ParseQQ1 6
(QQ6 7
readerQQ7 =
[QQ= >
$strQQ> B
]QQB C
.QQC D
ToStringQQD L
(QQL M
)QQM N
)QQN O
;QQO P
retornoRR  '
.RR' (
NomeRR( ,
=RR- .
readerRR/ 5
[RR5 6
$strRR6 <
]RR< =
.RR= >
ToStringRR> F
(RRF G
)RRG H
;RRH I
retornoSS  '
.SS' (
IdadeSS( -
=SS. /
shortSS0 5
.SS5 6
ParseSS6 ;
(SS; <
readerSS< B
[SSB C
$strSSC J
]SSJ K
.SSK L
ToStringSSL T
(SST U
)SSU V
)SSV W
;SSW X
retornoTT  '
.TT' (
EmailTT( -
=TT. /
readerTT0 6
[TT6 7
$strTT7 >
]TT> ?
.TT? @
ToStringTT@ H
(TTH I
)TTI J
;TTJ K
retornoUU  '
.UU' (
DataNascimentoUU( 6
=UU7 8
DateTimeUU9 A
.UUA B
ParseUUB G
(UUG H
readerUUH N
[UUN O
$strUUO _
]UU_ `
.UU` a
ToStringUUa i
(UUi j
)UUj k
)UUk l
;UUl m
}VV 
}WW 
}XX 
returnZZ 
retornoZZ "
;ZZ" #
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
throw^^ 
new^^ 
	Exception^^ '
(^^' (
$"^^( *
{^^* +
ex^^+ -
.^^- .
Message^^. 5
}^^5 6
$str^^6 9
{^^9 :
ex^^: <
.^^< =

StackTrace^^= G
}^^G H
"^^H I
)^^I J
;^^J K
}__ 
finally`` 
{aa 
connbb 
.bb 
Closebb 
(bb 
)bb  
;bb  !
}cc 
}dd 
}ee 	
publicgg 
IEnumerablegg 
<gg 
ClienteDomaingg (
>gg( )
GetAllgg* 0
(gg0 1
ClienteArgsgg1 <
argsgg= A
)ggA B
{hh 	
Listii 
<ii 
ClienteDomainii 
>ii 
retornoii  '
=ii( )
newii* -
Listii. 2
<ii2 3
ClienteDomainii3 @
>ii@ A
(iiA B
)iiB C
;iiC D
usingkk 
(kk 
SqlConnectionkk  
connkk! %
=kk& '
newkk( +
SqlConnectionkk, 9
(kk9 :
SqlConnectionStringkk: M
)kkM N
)kkN O
{ll 
trymm 
{nn 
connoo 
.oo 
Openoo 
(oo 
)oo 
;oo  
usingqq 
(qq 

SqlCommandqq %
commqq& *
=qq+ ,
connqq- 1
.qq1 2
CreateCommandqq2 ?
(qq? @
)qq@ A
)qqA B
{rr 
commss 
.ss 
CommandTypess (
=ss) *
CommandTypess+ 6
.ss6 7
Textss7 ;
;ss; <
commtt 
.tt 
CommandTexttt (
=tt) *
$strtt+ Q
;ttQ R
ifvv 
(vv 
argsvv  
.vv  !
Idvv! #
>vv$ %
$numvv& '
)vv' (
{ww 
commxx  
.xx  !
CommandTextxx! ,
+=xx- /
$strxx0 @
;xx@ A
commyy  
.yy  !

Parametersyy! +
.yy+ ,
Addyy, /
(yy/ 0
newyy0 3
SqlParameteryy4 @
(yy@ A
$stryyA F
,yyF G
argsyyH L
.yyL M
IdyyM O
)yyO P
)yyP Q
;yyQ R
}zz 
if|| 
(|| 
!|| 
string|| #
.||# $
IsNullOrEmpty||$ 1
(||1 2
args||2 6
.||6 7
Nome||7 ;
)||; <
)||< =
{}} 
comm~~  
.~~  !
CommandText~~! ,
+=~~- /
$str~~0 D
;~~D E
comm  
.  !

Parameters! +
.+ ,
Add, /
(/ 0
new0 3
SqlParameter4 @
(@ A
$strA H
,H I
argsJ N
.N O
NomeO S
)S T
)T U
;U V
}
€€ 
using
‚‚ 
(
‚‚ 
SqlDataReader
‚‚ ,
reader
‚‚- 3
=
‚‚4 5
comm
‚‚6 :
.
‚‚: ;
ExecuteReader
‚‚; H
(
‚‚H I
)
‚‚I J
)
‚‚J K
{
ƒƒ 
if
„„ 
(
„„  
reader
„„  &
.
„„& '
HasRows
„„' .
)
„„. /
{
…… 
while
††  %
(
††& '
reader
††' -
.
††- .
Read
††. 2
(
††2 3
)
††3 4
)
††4 5
{
‡‡  !
var
ˆˆ$ '
cliente
ˆˆ( /
=
ˆˆ0 1
new
ˆˆ2 5
ClienteDomain
ˆˆ6 C
(
ˆˆC D
)
ˆˆD E
;
ˆˆE F
cliente
ŠŠ$ +
.
ŠŠ+ ,
Id
ŠŠ, .
=
ŠŠ/ 0
int
ŠŠ1 4
.
ŠŠ4 5
Parse
ŠŠ5 :
(
ŠŠ: ;
reader
ŠŠ; A
[
ŠŠA B
$str
ŠŠB F
]
ŠŠF G
.
ŠŠG H
ToString
ŠŠH P
(
ŠŠP Q
)
ŠŠQ R
)
ŠŠR S
;
ŠŠS T
cliente
‹‹$ +
.
‹‹+ ,
Nome
‹‹, 0
=
‹‹1 2
reader
‹‹3 9
[
‹‹9 :
$str
‹‹: @
]
‹‹@ A
.
‹‹A B
ToString
‹‹B J
(
‹‹J K
)
‹‹K L
;
‹‹L M
cliente
ŒŒ$ +
.
ŒŒ+ ,
Idade
ŒŒ, 1
=
ŒŒ2 3
short
ŒŒ4 9
.
ŒŒ9 :
Parse
ŒŒ: ?
(
ŒŒ? @
reader
ŒŒ@ F
[
ŒŒF G
$str
ŒŒG N
]
ŒŒN O
.
ŒŒO P
ToString
ŒŒP X
(
ŒŒX Y
)
ŒŒY Z
)
ŒŒZ [
;
ŒŒ[ \
cliente
$ +
.
+ ,
Email
, 1
=
2 3
reader
4 :
[
: ;
$str
; B
]
B C
.
C D
ToString
D L
(
L M
)
M N
;
N O
cliente
ŽŽ$ +
.
ŽŽ+ ,
DataNascimento
ŽŽ, :
=
ŽŽ; <
DateTime
ŽŽ= E
.
ŽŽE F
Parse
ŽŽF K
(
ŽŽK L
reader
ŽŽL R
[
ŽŽR S
$str
ŽŽS c
]
ŽŽc d
.
ŽŽd e
ToString
ŽŽe m
(
ŽŽm n
)
ŽŽn o
)
ŽŽo p
;
ŽŽp q
retorno
$ +
.
+ ,
Add
, /
(
/ 0
cliente
0 7
)
7 8
;
8 9
}
‘‘  !
}
’’ 
}
““ 
}
”” 
return
–– 
retorno
–– "
;
––" #
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜  
ex
˜˜! #
)
˜˜# $
{
™™ 
throw
šš 
new
šš 
	Exception
šš '
(
šš' (
$"
šš( *
{
šš* +
ex
šš+ -
.
šš- .
Message
šš. 5
}
šš5 6
$str
šš6 9
{
šš9 :
ex
šš: <
.
šš< =

StackTrace
šš= G
}
ššG H
"
ššH I
)
ššI J
;
ššJ K
}
›› 
finally
œœ 
{
 
conn
žž 
.
žž 
Close
žž 
(
žž 
)
žž  
;
žž  !
}
ŸŸ 
}
   
}
¡¡ 	
public
££ 
int
££ 
Insert
££ 
(
££ 
ClienteDomain
££ '
model
££( -
)
££- .
{
¤¤ 	
int
¥¥ 
retorno
¥¥ 
=
¥¥ 
$num
¥¥ 
;
¥¥ 
using
§§ 
(
§§ 
SqlConnection
§§  
conn
§§! %
=
§§& '
new
§§( +
SqlConnection
§§, 9
(
§§9 :!
SqlConnectionString
§§: M
)
§§M N
)
§§N O
{
¨¨ 
try
©© 
{
ªª 
conn
«« 
.
«« 
Open
«« 
(
«« 
)
«« 
;
««  
using
­­ 
(
­­ 

SqlCommand
­­ %
comm
­­& *
=
­­+ ,
conn
­­- 1
.
­­1 2
CreateCommand
­­2 ?
(
­­? @
)
­­@ A
)
­­A B
{
®® 
comm
¯¯ 
.
¯¯ 
CommandType
¯¯ (
=
¯¯) *
CommandType
¯¯+ 6
.
¯¯6 7
Text
¯¯7 ;
;
¯¯; <
comm
°° 
.
°° 
CommandText
°° (
=
°°) *
$str°°+ ¢
;°°¢ £
comm
²² 
.
²² 

Parameters
²² '
.
²²' (
Add
²²( +
(
²²+ ,
new
²², /
SqlParameter
²²0 <
(
²²< =
$str
²²= D
,
²²D E
model
²²F K
.
²²K L
Nome
²²L P
)
²²P Q
)
²²Q R
;
²²R S
comm
³³ 
.
³³ 

Parameters
³³ '
.
³³' (
Add
³³( +
(
³³+ ,
new
³³, /
SqlParameter
³³0 <
(
³³< =
$str
³³= E
,
³³E F
model
³³G L
.
³³L M
Idade
³³M R
)
³³R S
)
³³S T
;
³³T U
comm
´´ 
.
´´ 

Parameters
´´ '
.
´´' (
Add
´´( +
(
´´+ ,
new
´´, /
SqlParameter
´´0 <
(
´´< =
$str
´´= E
,
´´E F
model
´´G L
.
´´L M
Email
´´M R
)
´´R S
)
´´S T
;
´´T U
comm
µµ 
.
µµ 

Parameters
µµ '
.
µµ' (
Add
µµ( +
(
µµ+ ,
new
µµ, /
SqlParameter
µµ0 <
(
µµ< =
$str
µµ= N
,
µµN O
model
µµP U
.
µµU V
DataNascimento
µµV d
)
µµd e
)
µµe f
;
µµf g
retorno
·· 
=
··  !
comm
··" &
.
··& '
ExecuteNonQuery
··' 6
(
··6 7
)
··7 8
;
··8 9
}
¸¸ 
return
ºº 
retorno
ºº "
;
ºº" #
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼  
ex
¼¼! #
)
¼¼# $
{
½½ 
throw
¾¾ 
new
¾¾ 
	Exception
¾¾ '
(
¾¾' (
$"
¾¾( *
{
¾¾* +
ex
¾¾+ -
.
¾¾- .
Message
¾¾. 5
}
¾¾5 6
$str
¾¾6 9
{
¾¾9 :
ex
¾¾: <
.
¾¾< =

StackTrace
¾¾= G
}
¾¾G H
"
¾¾H I
)
¾¾I J
;
¾¾J K
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
conn
ÂÂ 
.
ÂÂ 
Close
ÂÂ 
(
ÂÂ 
)
ÂÂ  
;
ÂÂ  !
}
ÃÃ 
}
ÄÄ 
}
ÅÅ 	
public
ÇÇ 
int
ÇÇ 
Update
ÇÇ 
(
ÇÇ 
ClienteDomain
ÇÇ '
model
ÇÇ( -
)
ÇÇ- .
{
ÈÈ 	
int
ÉÉ 
retorno
ÉÉ 
=
ÉÉ 
$num
ÉÉ 
;
ÉÉ 
using
ËË 
(
ËË 
SqlConnection
ËË  
conn
ËË! %
=
ËË& '
new
ËË( +
SqlConnection
ËË, 9
(
ËË9 :!
SqlConnectionString
ËË: M
)
ËËM N
)
ËËN O
{
ÌÌ 
try
ÍÍ 
{
ÎÎ 
conn
ÏÏ 
.
ÏÏ 
Open
ÏÏ 
(
ÏÏ 
)
ÏÏ 
;
ÏÏ  
using
ÑÑ 
(
ÑÑ 

SqlCommand
ÑÑ %
comm
ÑÑ& *
=
ÑÑ+ ,
conn
ÑÑ- 1
.
ÑÑ1 2
CreateCommand
ÑÑ2 ?
(
ÑÑ? @
)
ÑÑ@ A
)
ÑÑA B
{
ÒÒ 
comm
ÓÓ 
.
ÓÓ 
CommandType
ÓÓ (
=
ÓÓ) *
CommandType
ÓÓ+ 6
.
ÓÓ6 7
Text
ÓÓ7 ;
;
ÓÓ; <
comm
ÔÔ 
.
ÔÔ 
CommandText
ÔÔ (
=
ÔÔ) *
$strÔÔ+ “
;ÔÔ“ ”
comm
ÖÖ 
.
ÖÖ 

Parameters
ÖÖ '
.
ÖÖ' (
Add
ÖÖ( +
(
ÖÖ+ ,
new
ÖÖ, /
SqlParameter
ÖÖ0 <
(
ÖÖ< =
$str
ÖÖ= A
,
ÖÖA B
model
ÖÖC H
.
ÖÖH I
Id
ÖÖI K
)
ÖÖK L
)
ÖÖL M
;
ÖÖM N
comm
×× 
.
×× 

Parameters
×× '
.
××' (
Add
××( +
(
××+ ,
new
××, /
SqlParameter
××0 <
(
××< =
$str
××= D
,
××D E
model
××F K
.
××K L
Nome
××L P
)
××P Q
)
××Q R
;
××R S
comm
ØØ 
.
ØØ 

Parameters
ØØ '
.
ØØ' (
Add
ØØ( +
(
ØØ+ ,
new
ØØ, /
SqlParameter
ØØ0 <
(
ØØ< =
$str
ØØ= E
,
ØØE F
model
ØØG L
.
ØØL M
Idade
ØØM R
)
ØØR S
)
ØØS T
;
ØØT U
comm
ÙÙ 
.
ÙÙ 

Parameters
ÙÙ '
.
ÙÙ' (
Add
ÙÙ( +
(
ÙÙ+ ,
new
ÙÙ, /
SqlParameter
ÙÙ0 <
(
ÙÙ< =
$str
ÙÙ= E
,
ÙÙE F
model
ÙÙG L
.
ÙÙL M
Email
ÙÙM R
)
ÙÙR S
)
ÙÙS T
;
ÙÙT U
comm
ÚÚ 
.
ÚÚ 

Parameters
ÚÚ '
.
ÚÚ' (
Add
ÚÚ( +
(
ÚÚ+ ,
new
ÚÚ, /
SqlParameter
ÚÚ0 <
(
ÚÚ< =
$str
ÚÚ= N
,
ÚÚN O
model
ÚÚP U
.
ÚÚU V
DataNascimento
ÚÚV d
)
ÚÚd e
)
ÚÚe f
;
ÚÚf g
retorno
ÜÜ 
=
ÜÜ  !
comm
ÜÜ" &
.
ÜÜ& '
ExecuteNonQuery
ÜÜ' 6
(
ÜÜ6 7
)
ÜÜ7 8
;
ÜÜ8 9
}
ÝÝ 
return
ßß 
retorno
ßß "
;
ßß" #
}
àà 
catch
áá 
(
áá 
	Exception
áá  
ex
áá! #
)
áá# $
{
ââ 
throw
ãã 
new
ãã 
	Exception
ãã '
(
ãã' (
$"
ãã( *
{
ãã* +
ex
ãã+ -
.
ãã- .
Message
ãã. 5
}
ãã5 6
$str
ãã6 9
{
ãã9 :
ex
ãã: <
.
ãã< =

StackTrace
ãã= G
}
ããG H
"
ããH I
)
ããI J
;
ããJ K
}
ää 
finally
åå 
{
ææ 
conn
çç 
.
çç 
Close
çç 
(
çç 
)
çç  
;
çç  !
}
èè 
}
éé 
}
êê 	
}
ëë 
}ìì 